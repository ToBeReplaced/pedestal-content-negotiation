<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>pedestal.content-negotiation documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Pedestal-content-negotiation 0.3.1 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li class="current"><a href="pedestal.content-negotiation.html"><span>pedestal.content-negotiation</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="pedestal.content-negotiation.html#var-content-negotiation"><span>content-negotiation</span></a></li><li><a href="pedestal.content-negotiation.html#var-default-routes"><span>default-routes</span></a></li><li><a href="pedestal.content-negotiation.html#var-default-wildcard-map"><span>default-wildcard-map</span></a></li><li><a href="pedestal.content-negotiation.html#var-replace-wildcards"><span>replace-wildcards</span></a></li><li><a href="pedestal.content-negotiation.html#var-route"><span>route</span></a></li><li><a href="pedestal.content-negotiation.html#var-route-map"><span>route-map</span></a></li><li><a href="pedestal.content-negotiation.html#var-routes"><span>routes</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>pedestal.content-negotiation documentation</h2><pre class="doc">Content negotiation for Pedestal web services.
</pre><div class="public" id="var-content-negotiation"><h3>content-negotiation</h3><div class="usage"><code>(content-negotiation)</code><code>(content-negotiation route-map)</code><code>(content-negotiation wildcard-map route-map)</code><code>(content-negotiation not-acceptable-response-fn wildcard-map route-map)</code></div><pre class="doc">Returns an interceptor that performs content negotiation.

On enter, it will attach the first supported content negotiation
route from route-map to ::content-negotiation in request if the
accept headers can be satisfied.  Otherwise, it attaches a 406 Not
Acceptable response to the context.  The not-acceptable-response-fn
returns a ring response and will be passed the request headers as a
single map argument.

On leave, it will check the status of the response.  If the status
is 200, it will update the response body using the function for the
route found on enter and set the &quot;Content-Type&quot; and
&quot;Content-Encoding&quot; headers appropriately, otherwise it will do
nothing.</pre></div><div class="public" id="var-default-routes"><h3>default-routes</h3><div class="usage"></div><pre class="doc">The default set of content negotiation routes that should be
supported in a route-map.</pre></div><div class="public" id="var-default-wildcard-map"><h3>default-wildcard-map</h3><div class="usage"></div><pre class="doc">The default wildcard map for use with replace-wildcards.
</pre></div><div class="public" id="var-replace-wildcards"><h3>replace-wildcards</h3><div class="usage"><code>(replace-wildcards route)</code><code>(replace-wildcards wildcard-map route)</code></div><pre class="doc">Replaces any wildcard values in route.  A wildcard map contains
values for :charset and :encoding that are used to replace their
corresponding values in route if they are set to &quot;*&quot;.  It also
contains a map for :content-type that pairs a content-type wildcard
like &quot;application/*&quot; with a replacement value.  The default
wildcard map is default-wildcard-map.</pre></div><div class="public" id="var-route"><h3>route</h3><div class="usage"><code>(route m)</code></div><pre class="doc">Returns a content negotiation route from a possibly incomplete
route.  A route contains the keys :content-type,
:content-type-params, :charset, and :encoding.  These correspond to
the &quot;accept&quot;, &quot;accept-charset&quot;, and &quot;accept-encoding&quot; headers
in an HTTP request.  A route specifies exactly one valid setting, so
it is common for an HTTP request's headers to specify many routes.</pre></div><div class="public" id="var-route-map"><h3>route-map</h3><div class="usage"><code>(route-map)</code><code>(route-map routes)</code></div><pre class="doc">Returns a map from a set of content negotiation routes to default
functions that can be used to write a clojure object to a pedestal
response body.  When no routes are passed in, default-routes are
used.  If there is no default function to handle a route passed in,
an ExceptionInfo with :type ::unhandled-route is raised.  The
default functions return functions that write to output streams.</pre></div><div class="public" id="var-routes"><h3>routes</h3><div class="usage"><code>(routes headers)</code></div><pre class="doc">Returns an ordered sequence of content negotiation routes from the
&quot;accept&quot; &quot;accept-charset&quot; and &quot;accept-encoding&quot; headers.
RFC-2616 is followed for prioritization, including the use of the q
parameter.</pre></div></div></body></html>